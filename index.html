<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#111827">
    <title>Compound Calculator</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* === RESET & BASIS (KEMBALI KE ASAL) === */
        :root {
            --bg-dark: #0c0a09;
            --surface: #1f2937;
            --gold: #d4af37;
            --gold-grad: linear-gradient(45deg, #d4af37, #f0c54a);
            --text-main: #f9fafb;
            --text-sub: #9ca3af;
            --border: #374151;
            --profit: #22c55e;
            --focus: rgba(212, 175, 55, 0.3);
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            overflow: hidden; /* Slide handle scroll sendiri */
        }

        /* === STRUKTUR SLIDE (YANG PASTI JALAN DI HP) === */
        .slide {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            padding: 1.5rem;
            box-sizing: border-box;
            transition: transform 0.5s ease;
            overflow-y: auto; /* KUNCI: Scroll vertikal aktif di semua mode */
        }
        
        /* Navigasi Slide */
        #slide1 { transform: translateX(0); z-index: 2; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        #slide2 { transform: translateX(100%); z-index: 1; padding-bottom: 50px; }
        
        body.kalkulator-aktif #slide1 { transform: translateX(-100%); }
        body.kalkulator-aktif #slide2 { transform: translateX(0); }

        /* === KOMPONEN VISUAL === */
        .logo { width: 150px; margin-bottom: 2rem; }
        
        h1 { 
            font-size: 2.2rem; margin-bottom: 1rem; 
            background: var(--gold-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        p { color: var(--text-sub); line-height: 1.6; max-width: 600px; margin-bottom: 2rem; }

        /* Container Kalkulator */
        .container {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            max-width: 600px; margin: 0 auto;
        }

        /* Input Form (Layout Grid Aman) */
        .form-grid {
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); /* Responsif aman */
            gap: 1.2rem; margin-bottom: 1.5rem;
        }
        .full-width { grid-column: 1 / -1; }

        label { display: block; color: var(--text-sub); margin-bottom: 0.5rem; font-size: 0.85rem; }
        
        input[type="number"] {
            width: 100%; padding: 12px;
            background: #111827; border: 1px solid var(--border);
            border-radius: 10px; color: #fff; font-size: 1rem;
            box-sizing: border-box;
        }
        input[type="number"]:focus { outline: none; border-color: var(--gold); box-shadow: 0 0 0 3px var(--focus); }

        /* Checkbox Group */
        .checkbox-group {
            display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center;
            background: rgba(0,0,0,0.2); padding: 10px; border-radius: 10px;
        }
        .checkbox-group label { margin: 0; display: flex; align-items: center; gap: 8px; cursor: pointer; color: #fff; }
        input[type="checkbox"] { width: 1.2rem; height: 1.2rem; accent-color: var(--gold); }

        /* Tombol */
        button {
            width: 100%; padding: 1rem;
            background: var(--gold-grad); color: #000;
            border: none; border-radius: 12px;
            font-weight: 700; font-size: 1rem; cursor: pointer;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
        .btn-back {
            background: rgba(31, 41, 55, 0.9); color: #fff;
            width: auto; padding: 0.5rem 1rem; margin-bottom: 1rem;
            position: sticky; top: 0; z-index: 50;
            backdrop-filter: blur(5px); border: 1px solid var(--border);
        }

        /* Tabel (Scroll Samping Aman) */
        .table-container {
            margin-top: 2rem; overflow-x: auto;
            border: 1px solid var(--border); border-radius: 12px;
            max-height: 500px;
        }
        table { width: 100%; border-collapse: collapse; min-width: 400px; }
        th { 
            background: #111827; padding: 12px; color: var(--text-sub); 
            position: sticky; top: 0; z-index: 10; text-align: center; font-size: 0.8rem;
        }
        td { 
            padding: 10px; border-bottom: 1px solid var(--border); 
            text-align: right; white-space: nowrap; font-size: 0.9rem;
        }
        /* Sticky Kolom Hari */
        td:first-child { 
            position: sticky; left: 0; background: var(--surface); z-index: 5; text-align: center; 
            border-right: 1px solid var(--border);
        }
        th:first-child { left: 0; z-index: 15; background: #111827; }

        .gold-text { color: var(--gold); }
        .profit-text { color: var(--profit); }
        
        /* State ditekan (Long Press) */
        td.is-pressing { background-color: var(--gold) !important; color: #000 !important; }
        td.is-pressing span { color: #000 !important; }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); display: none; 
            justify-content: center; align-items: center; z-index: 1000;
            backdrop-filter: blur(5px);
        }
        .modal-overlay.active { display: flex; }
        .modal-content {
            background: var(--surface); padding: 2rem; border-radius: 20px;
            text-align: center; border: 1px solid var(--gold); min-width: 300px; position: relative;
        }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 1.5rem; cursor: pointer; color: #fff; }

    </style>
</head>
<body>

    <div id="slide1" class="slide">
        <img src="logo.png" alt="Logo" class="logo">
        <h1>Selamat Datang di Compound</h1>
        <p>Setiap keuntungan kecil yang Anda putar kembali adalah benih untuk pohon kekayaan di masa depan.</p>
        <button onclick="navigasiKe('kalkulator')" style="max-width: 250px;">Mulai Simulasi</button>
    </div>

    <div id="slide2" class="slide">
        <button class="btn-back" onclick="navigasiKe('depan')">&larr; Kembali</button>
        
        <div class="container">
            <h2 style="text-align:center; color:var(--gold); margin-top:0;">Kalkulator Compound</h2>
            <div id="kursDisplay" style="text-align:center; color:var(--text-sub); margin-bottom:1.5rem; font-size:0.9rem;">Loading Kurs...</div>

            <div class="form-grid">
                <div class="full-width">
                    <label>MODAL AWAL (USDT)</label>
                    <input type="number" id="modal" value="100" step="0.01">
                </div>
                <div>
                    <label>TARGET HARI</label>
                    <input type="number" id="targetHari" value="41">
                </div>
                <div>
                    <label>PROFIT PER SESI (%)</label>
                    <input type="number" id="bep" value="0.85" step="0.01">
                </div>
                <div class="full-width">
                    <label>SESI AKTIF</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="siang" checked> Siang</label>
                        <label><input type="checkbox" id="sinyal4"> Sinyal-4</label>
                        <label><input type="checkbox" id="sinyal3"> Sinyal-3</label>
                        <label><input type="checkbox" id="malam" checked> Malam</label>
                    </div>
                </div>
            </div>

            <button onclick="hitung()">Hitung Potensi</button>

            <div class="table-container">
                <table id="hasilTabel">
                    <thead></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="modalKonversi" class="modal-overlay">
        <div class="modal-content">
            <span class="close-btn" onclick="tutupModal()">&times;</span>
            <div id="modalUsd" style="font-size:1.2rem; color:var(--text-sub); margin-bottom:5px;"></div>
            <div id="modalIdr" style="font-size:2rem; font-weight:bold; color:#fff;"></div>
            <div style="font-size:0.8rem; color:var(--text-sub); margin-top:10px;">Estimasi Rupiah</div>
        </div>
    </div>

    <script>
        // === FUNGSI UTAMA YANG ANDA MINTA JANGAN DIUBAH ===
        
        let kursLive = 16300; 
        const modalEl = document.getElementById('modalKonversi');
        const modalInput = document.getElementById('modal');

        function navigasiKe(tujuan) {
            if(tujuan === 'kalkulator') document.body.classList.add('kalkulator-aktif');
            else document.body.classList.remove('kalkulator-aktif');
        }

        async function updateKurs() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=tether&vs_currencies=idr');
                const data = await res.json();
                kursLive = data.tether.idr;
                document.getElementById('kursDisplay').innerText = `1 USDT = Rp ${kursLive.toLocaleString('id-ID')}`;
            } catch (e) {
                document.getElementById('kursDisplay').innerText = `Kurs Manual: 1 USDT = Rp ${kursLive.toLocaleString('id-ID')}`;
            }
        }

        function formatUsd(n) {
            return `<span class="gold-text">$</span>${n.toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2})}`;
        }

        function hitung() {
            const modal = parseFloat(document.getElementById('modal').value) || 0;
            const hari = parseInt(document.getElementById('targetHari').value) || 1;
            const bep = parseFloat(document.getElementById('bep').value) / 100 || 0;
            
            const aktif = {
                s: document.getElementById('siang').checked,
                s4: document.getElementById('sinyal4').checked,
                s3: document.getElementById('sinyal3').checked,
                m: document.getElementById('malam').checked
            };

            const thead = document.querySelector('#hasilTabel thead');
            const tbody = document.querySelector('#hasilTabel tbody');
            tbody.innerHTML = ''; 

            // Header
            let h = '<tr><th>Hari</th><th>Modal Awal</th>';
            if(aktif.s) h += '<th>Siang</th>';
            if(aktif.s4) h += '<th>Sinyal-4</th>';
            if(aktif.s3) h += '<th>Sinyal-3</th>';
            if(aktif.m) h += '<th>Malam</th>';
            h += '<th>Akhir</th><th>Total Profit</th></tr>';
            thead.innerHTML = h;

            let saldo = modal;
            let totalProfit = 0;

            for(let i=1; i<=hari; i++) {
                let start = saldo;
                let pS=0, pS4=0, pS3=0, pM=0;

                if(aktif.s) { pS = saldo * bep; saldo += pS; }
                if(aktif.s4) { pS4 = saldo * bep; saldo += pS4; }
                if(aktif.s3) { pS3 = saldo * bep; saldo += pS3; }
                if(aktif.m) { pM = saldo * bep; saldo += pM; }

                let end = saldo;
                let daily = end - start;
                totalProfit += daily;

                let row = `<tr>
                    <td>${i}</td>
                    <td data-val="${start}">${formatUsd(start)}</td>`;
                
                if(aktif.s) row += `<td class="profit-text" data-val="${pS}">${formatUsd(pS)}</td>`;
                if(aktif.s4) row += `<td class="profit-text" data-val="${pS4}">${formatUsd(pS4)}</td>`;
                if(aktif.s3) row += `<td class="profit-text" data-val="${pS3}">${formatUsd(pS3)}</td>`;
                if(aktif.m) row += `<td class="profit-text" data-val="${pM}">${formatUsd(pM)}</td>`;

                row += `<td data-val="${end}">${formatUsd(end)}</td>
                        <td class="profit-text" data-val="${totalProfit}">${formatUsd(totalProfit)}</td>
                </tr>`;
                
                tbody.insertAdjacentHTML('beforeend', row);
            }
        }

        // === FITUR PRESS & CLICK (DARI FILE ASLI) ===
        function tutupModal() { modalEl.classList.remove('active'); }

        document.addEventListener('DOMContentLoaded', () => {
            updateKurs().then(hitung);

            const tbody = document.querySelector('tbody');
            let timer;
            let longPress = false;

            // Touch Logic
            const start = (e) => {
                const cell = e.target.closest('td');
                if(!cell || !cell.hasAttribute('data-val')) return;
                
                longPress = false;
                // Logika: Hanya kolom 'Akhir' (biasanya 2 dari kanan) yang bisa dicopy ke input
                // Tapi user minta jangan dirubah, jadi kita izinkan logika asli
                
                const row = cell.parentElement;
                // Cek kolom ke-2 dari belakang (Modal Akhir)
                if (row.children[row.children.length - 2] === cell) {
                    timer = setTimeout(() => {
                        longPress = true;
                        cell.classList.add('is-pressing');
                        
                        // Action Copy
                        const val = parseFloat(cell.getAttribute('data-val'));
                        modalInput.value = val.toFixed(2);
                        hitung(); // Refresh hitungan
                        
                        // Visual Feedback Input
                        modalInput.style.borderColor = '#22c55e';
                        setTimeout(() => modalInput.style.borderColor = '', 500);

                    }, 600); // 600ms tahan
                }
            };

            const end = (e) => {
                clearTimeout(timer);
                const cell = e.target.closest('td');
                if(cell) cell.classList.remove('is-pressing');

                if(!longPress && cell && cell.hasAttribute('data-val')) {
                    // Klik biasa = Buka Modal
                    const val = parseFloat(cell.getAttribute('data-val'));
                    document.getElementById('modalUsd').innerHTML = formatUsd(val);
                    document.getElementById('modalIdr').innerText = `Rp ${(val * kursLive).toLocaleString('id-ID')}`;
                    modalEl.classList.add('active');
                }
            };

            const cancel = () => {
                clearTimeout(timer);
                const pressing = document.querySelector('.is-pressing');
                if(pressing) pressing.classList.remove('is-pressing');
            };

            tbody.addEventListener('mousedown', start);
            tbody.addEventListener('touchstart', start, {passive:true});
            tbody.addEventListener('mouseup', end);
            tbody.addEventListener('touchend', end);
            tbody.addEventListener('mousemove', cancel);
            tbody.addEventListener('touchmove', cancel);
        });
    </script>
</body>
</html>
